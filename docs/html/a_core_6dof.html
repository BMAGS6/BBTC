<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BMAGS Ballistic Trajectory Calculator: Six Degrees of Freedom (6DOF) Physics Engine</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">BMAGS Ballistic Trajectory Calculator
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('a_core_6dof.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Six Degrees of Freedom (6DOF) Physics Engine</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#intro">Introduction</a></li>
<li class="level1"><a href="#motion">Translational Dynamics</a></li>
<li class="level1"><a href="#rotation">Rotational Dynamics</a></li>
<li class="level1"><a href="#forces">Forces Modeled</a></li>
<li class="level1"><a href="#stability">Numerical Stability and Performance</a></li>
<li class="level1"><a href="#output">Output Logging</a></li>
<li class="level1"><a href="#sim_loop">6DOF Simulation Loop</a><ul><li class="level2"><a href="#theory_vs_impl">Theory vs. Implementation Table</a></li>
</ul>
</li>
<li class="level1"><a href="#next">Future Work</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>The 6DOF (Six Degrees of Freedom) solver in BBTC models a bullet’s full spatial motion: translation in X, Y, Z and rotation around pitch, yaw, and roll axes. It is a high-precision simulation that treats the projectile as a rigid body subject to aerodynamic, gravitational, and rotational forces.</p>
<p>This is not a simplistic point-mass solver. It tracks:</p><ul>
<li>3D position and linear velocity</li>
<li>3D angular velocity and orientation using quaternions</li>
<li>Environmental variables (air density, wind, humidity, etc.)</li>
<li>Variable drag coefficients from Mach-dependent tables (G1, G7)</li>
</ul>
<p>The system runs at fixed time steps and integrates motion using RK4 (Runge-Kutta 4th order) for both translational and rotational dynamics, ensuring accurate trajectories even under extreme velocities and long times of flight.</p>
<h1><a class="anchor" id="motion"></a>
Translational Dynamics</h1>
<p><b>Newton’s Second Law</b> governs linear acceleration:</p>
<p class="formulaDsp">
\[
   \mathbf{F}_{\mathrm{net}} = m \cdot \mathbf{a} \Rightarrow \vec{a} = \frac{\mathbf{F}_{\mathrm{net}}}{m}
   \]
</p>
<p>Forces computed per step:</p><ul>
<li>Gravity: \( \mathbf{F}_g = m \cdot \mathbf{g} \)</li>
<li>Drag: \( \mathbf{F}_d = -\frac{1}{2} \rho C_d A \|\mathbf{v}\| \mathbf{v} \)</li>
<li>Wind correction (if enabled)</li>
</ul>
<p>Drag coefficient \( C_d \) is determined dynamically using Mach number and interpolated from the drag table selected by the user that coresponds to their desired drag model.</p>
<p>RK4 integration is applied:</p>
<p class="formulaDsp">
\[
   \begin{array}{rl}
   k_1 &amp; = f(t, \mathbf{v}) \\\\
   k_2 &amp; = f\left(t + \frac{\Delta t}{2}, \mathbf{v} + \frac{\Delta t}{2}k_1\right) \\\\
   k_3 &amp; = f\left(t + \frac{\Delta t}{2}, \mathbf{v} + \frac{\Delta t}{2}k_2\right) \\\\
   k_4 &amp; = f(t + \Delta t, \mathbf{v} + \Delta t \cdot k_3) \\\\
   \mathbf{v}_{t+\Delta t} &amp; = \mathbf{v}_t + \frac{\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4)
   \end{array}
   \]
</p>
<h1><a class="anchor" id="rotation"></a>
Rotational Dynamics</h1>
<p>Angular velocity \( \mathbf{\omega} \) is integrated via quaternion differential equations. The quaternion \( q \) representing orientation is updated as:</p>
<p class="formulaDsp">
\[ \frac{dq}{dt} = \frac{1}{2} q \otimes \omega_q \]
</p>
<p>Where:</p><ul>
<li>\( \omega_q = (0, \mathbf{\omega}) \) is the angular velocity as a pure quaternion</li>
<li>\( \otimes \) is quaternion multiplication</li>
</ul>
<p>The rotational integration also uses RK4 and includes normalization at every step to prevent drift from accumulating.</p>
<h1><a class="anchor" id="forces"></a>
Forces Modeled</h1>
<p>Current aerodynamic and environmental forces modeled:</p><ul>
<li>Gravity</li>
<li>Mach-dependent drag</li>
<li>Static wind (constant direction and magnitude)</li>
<li>Air density variation via altitude and humidity</li>
<li>Speed of sound adjustment via temperature and humidity</li>
<li>Bullet spin decay due to air resistance</li>
<li>Lift via yaw-induced and pitch-induced terms</li>
<li>Coriolis force (Earth’s rotation)</li>
<li>Eötvös effect (horizontal velocity interacting with Earth rotation)</li>
<li>Latitude-based gravity and curvature approximation</li>
</ul>
<p>Wind is modeled as a fixed 3D vector for now. The idea of sinusoidal fluctuation (e.g., gusting wind patterns modeled by sine waves) is <b>not yet implemented</b> but may be considered in future releases.</p>
<p>Spin decay is modeled by reducing angular velocity over time with air resistance: </p><p class="formulaDsp">
\[ \mathbf{\omega}_{\mathrm{new}} = \mathbf{\omega}_{\mathrm{old}} \cdot (1 - \alpha \Delta t) \]
</p>
<p> where \( \alpha \) is an empirical decay constant.</p>
<h1><a class="anchor" id="stability"></a>
Numerical Stability and Performance</h1>
<p>RK4 offers excellent tradeoff between stability and speed. Time steps must remain small enough to capture high-speed changes, especially in supersonic regimes.</p>
<p>Units are strictly <b>SI internally</b>.</p>
<p><b>No dynamic memory allocation </b> is used anywhere in the solver. It’s completely stack-based and deterministic for maximum speed, portability, and safety.</p>
<h1><a class="anchor" id="output"></a>
Output Logging</h1>
<p>Output is written to a CSV file for every time step, including:</p><ul>
<li>Time, position, and velocity</li>
<li>Orientation (quaternion and Euler angles)</li>
<li>Angular velocity</li>
<li>Mach number and drag</li>
<li>Air density, temperature, speed of sound</li>
</ul>
<p>This allows for visualization in gnuplot or post-hoc analysis tools.</p>
<h1><a class="anchor" id="sim_loop"></a>
6DOF Simulation Loop</h1>
<p>This diagram outlines the core loop of the 6-degree-of-freedom simulation engine. It shows how the state of the bullet is advanced over time through force computation and integration. Each box represents a high-level operation performed per timestep.</p>
<div class="dotgraph">
<img src="dot_inline_dotgraph_1.png" alt="dot_inline_dotgraph_1.png" border="0" usemap="#dot_inline_dotgraph_1.map"/>
</div>
<h2><a class="anchor" id="theory_vs_impl"></a>
Theory vs. Implementation Table</h2>
<p>This table maps physical models used in the 6DOF simulation to their mathematical formulations and code-level implementations based on the actual contents of <code><a class="el" href="6dof_8c.html" title="6 degrees-of-freedom (6 D.O.F.) ballistic solver implementation.">6dof.c</a></code> , <code><a class="el" href="environment_8c.html" title="Implements functions for atmospheric and environmental calculations.">environment.c</a></code> , <code><a class="el" href="quat_8c.html" title="Implements quaternion-based rotation utilities.">quat.c</a></code> , and <code><a class="el" href="load__drag__tables_8c.html" title="Contains functions to load and interpolate drag tables from CSV files.">load_drag_tables.c</a></code>.</p>
<h2><a class="anchor" id="theory_vs_impl"></a>
Theory vs. Implementation Table</h2>
<p></p>
<h1><a class="anchor" id="next"></a>
Future Work</h1>
<p>Planned and Potential additions:</p><ul>
<li>An optional second CSV in U.S. Customary units, if enabled</li>
<li>Gusting wind (sinusoidal or Perlin-based)</li>
<li>Live weather and location gathering for user to apply weather parameters based on their location</li>
<li>Real-time zeroing correction</li>
<li>Surface impact modeling (angle, penetration, ricochet logic)</li>
<li>User-defined targets and hit/miss logging</li>
<li>Integration with graphical front-end (OpenGL or SDL)</li>
</ul>
<p>BBTC’s 6DOF engine serves as both an educational reference and a highly accurate simulator for short- and long-range, real-world inspired ballistics. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
